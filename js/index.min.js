function drawChessBoard(){for(var o=0;o<15;o++)context.moveTo(15+30*o,15),context.lineTo(15+30*o,435),context.stroke(),context.moveTo(15,15+30*o),context.lineTo(435,15+30*o),context.stroke()}function oneStep(o,r,t){context.beginPath(),context.arc(15+30*o,15+30*r,13,0,2*Math.PI),context.closePath();var n=context.createRadialGradient(15+30*o+2,15+30*r-2,13,5+30*o+2,15+30*r-2,0);t?(n.addColorStop(0,"#0a0a0a"),n.addColorStop(1,"#636766")):(n.addColorStop(0,"#d1d1d1"),n.addColorStop(1,"#f9f9f9")),context.fillStyle=n,context.fill()}function computerAI(){for(var o=[],r=[],t=0,n=0,e=0,i=0;i<15;i++){o[i]=[],r[i]=[];for(var a=0;a<15;a++)o[i][a]=0,r[i][a]=0}for(var i=0;i<15;i++)for(var a=0;a<15;a++)if(0==chessBoard[i][a]){for(var c=0;c<count;c++)wins[i][a][c]&&(1==myWin[c]?o[i][a]+=200:2==myWin[c]?o[i][a]+=400:3==myWin[c]?o[i][a]+=2e3:4==myWin[c]&&(o[i][a]+=1e4),1==computerWin[c]?r[i][a]+=220:2==computerWin[c]?r[i][a]+=420:3==computerWin[c]?r[i][a]+=2100:4==computerWin[c]&&(r[i][a]+=2e4));o[i][a]>t?(t=o[i][a],n=i,e=a):o[i][a]==t&&r[i][i]>r[n][e]&&(n=i,e=a),r[i][a]>t?(t=r[i][a],n=i,e=a):r[i][a]==t&&o[i][i]>o[n][e]&&(n=i,e=a)}oneStep(n,e,!1),chessBoard[n][e]=2;for(var c=0;c<count;c++)wins[n][e][c]&&(computerWin[c]++,myWin[c]=6,5==computerWin[c]&&(window.alert("noob!"),over=!0));over||(flag=!flag)}for(var chess=document.getElementById("chess"),context=chess.getContext("2d"),flag=!0,over=!1,chessBoard=[],i=0;i<15;i++){chessBoard[i]=[];for(var j=0;j<15;j++)chessBoard[i][j]=[]}for(var wins=[],count=0,myWin=[],computerWin=[],i=0;i<15;i++){wins[i]=[];for(var j=0;j<15;j++)wins[i][j]=[]}for(var i=0;i<15;i++)for(var j=0;j<11;j++){for(var k=0;k<5;k++)wins[i][j+k][count]=!0;count++}for(var i=0;i<11;i++)for(var j=0;j<15;j++){for(var k=0;k<5;k++)wins[i+k][j][count]=!0;count++}for(var i=0;i<11;i++)for(var j=0;j<11;j++){for(var k=0;k<5;k++)wins[i+k][j+k][count]=!0;count++}for(var i=0;i<11;i++)for(var j=14;j>3;j--){for(var k=0;k<5;k++)wins[i+k][j-k][count]=!0;count++}console.log(count);for(var i=0;i<count;i++)myWin[i]=0,computerWin[i]=0;context.strokeStyle="#bfbfbf";var logo=new Image;logo.src="images/qipan.jpg",logo.onload=function(){context.drawImage(logo,0,0,450,450),drawChessBoard()},chess.onclick=function(o){if(!over&&flag){var r=o.offsetX,t=o.offsetY,n=Math.floor(r/30),e=Math.floor(t/30);if(0==chessBoard[n][e]){oneStep(n,e,flag),chessBoard[n][e]=1;for(var i=0;i<count;i++)wins[n][e][i]&&(myWin[i]++,computerWin[i]=6,5==myWin[i]&&(window.alert("你赢了"),over=!0));over||(flag=!flag,computerAI())}}};